{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Dockerfile Contract",
  "description": "Contract defining the structure and requirements for the Dockerfile",
  "type": "object",
  "properties": {
    "base_image": {
      "type": "string",
      "pattern": "^node:(18|20)-alpine$",
      "description": "Node.js Alpine base image"
    },
    "working_directory": {
      "type": "string",
      "const": "/app",
      "description": "Application working directory"
    },
    "exposed_port": {
      "type": "integer",
      "const": 3000,
      "description": "Port exposed by the container"
    },
    "user": {
      "type": "string",
      "const": "nextjs",
      "description": "Non-root user for security"
    },
    "health_check": {
      "type": "object",
      "properties": {
        "test": {
          "type": "string",
          "const": "curl -f http://localhost:3000/api/health || exit 1"
        },
        "interval": {
          "type": "string",
          "const": "30s"
        },
        "timeout": {
          "type": "string",
          "const": "10s"
        },
        "retries": {
          "type": "integer",
          "const": 3
        }
      },
      "required": ["test", "interval", "timeout", "retries"]
    }
  },
  "required": ["base_image", "working_directory", "exposed_port", "user", "health_check"]
}